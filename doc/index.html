<!-- saved from url=(0022)http://internet.e-mail -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<?xml version="1.0" encoding="utf-8"?><HTML lang=en xml:lang="en" 
xmlns="http://www.w3.org/1999/xhtml"><HEAD><TITLE>NG4J - Named Graphs API for Jena</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<STYLE type=text/css>

BODY {
	PADDING-RIGHT: 1em; PADDING-LEFT: 70px; BACKGROUND: white fixed no-repeat left top; PADDING-BOTTOM: 2em; MARGIN: 0px; COLOR: black; PADDING-TOP: 2em; FONT-FAMILY: sans-serif
}
:link {
	BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: #00c
}
:visited {
	BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: #609
}
A:active {
	BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: #c00
}
A:link IMG {
	BORDER-TOP-STYLE: none; BORDER-RIGHT-STYLE: none; BORDER-LEFT-STYLE: none; BORDER-BOTTOM-STYLE: none
}
A:visited IMG {
	BORDER-TOP-STYLE: none; BORDER-RIGHT-STYLE: none; BORDER-LEFT-STYLE: none; BORDER-BOTTOM-STYLE: none
}
A IMG {
	COLOR: white
}

@media All    
{
A IMG {
	
}
    }
TH {
	FONT-FAMILY: sans-serif
}
TD {
	FONT-FAMILY: sans-serif
}
H1 {
	TEXT-ALIGN: left
}
H2 {
	TEXT-ALIGN: left
}
H3 {
	TEXT-ALIGN: left
}
H4 {
	TEXT-ALIGN: left
}
H5 {
	TEXT-ALIGN: left
}
H6 {
	TEXT-ALIGN: left
}
H1 {
	BACKGROUND: white; COLOR: #005a9c
}
H2 {
	BACKGROUND: white; COLOR: #005a9c
}
H3 {
	BACKGROUND: white; COLOR: #005a9c
}
H1 {
	FONT: 170% sans-serif
}
H2 {
	FONT: 140% sans-serif
}
H3 {
	FONT: 120% sans-serif
}
H4 {
	FONT: bold 100% sans-serif
}
H5 {
	FONT: italic 100% sans-serif
}
H6 {
	FONT: small-caps 100% sans-serif
}
.hide {
	DISPLAY: none
}
DIV.head {
	MARGIN-BOTTOM: 1em
}
DIV.head H1 {
	CLEAR: both; MARGIN-TOP: 2em
}
DIV.head TABLE {
	MARGIN-TOP: 2em; MARGIN-LEFT: 2em
}
P.copyright {
	FONT-SIZE: small
}
P.copyright SMALL {
	FONT-SIZE: small
}

@media Screen    
{
UNKNOWN {
	BACKGROUND: #ffa
}
    }
PRE {
	MARGIN-LEFT: 2em
}
DT {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
DD {
	MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px
}
DT {
	FONT-WEIGHT: bold
}
PRE {
	FONT-FAMILY: monospace
}
CODE {
	FONT-FAMILY: monospace
}
UL.toc {
	LIST-STYLE-TYPE: none
}

@media Aural    
{
H1 {
	stress: 20; richness: 90
}
H2 {
	stress: 20; richness: 90
}
H3 {
	stress: 20; richness: 90
}
.hide {
	speak: none
}
P.copyright {
	volume: x-soft; speech-rate: x-fast
}
DT {
	pause-before: 20%
}
PRE {
	speak-punctuation: code
}
}

DIV.exampleInner PRE {
	MARGIN-TOP: 0em; MARGIN-BOTTOM: 0em; MARGIN-LEFT: 0em; FONT-FAMILY: monospace
}
DIV.exampleOuter {
	BORDER-RIGHT: gray 4px double; PADDING-RIGHT: 0em; BORDER-TOP: gray 4px double; PADDING-LEFT: 0em; PADDING-BOTTOM: 0em; MARGIN: 0em; BORDER-LEFT: gray 4px double; PADDING-TOP: 0em; BORDER-BOTTOM: gray 4px double
}
DIV.exampleInner {
	PADDING-RIGHT: 4px; PADDING-LEFT: 4px; PADDING-BOTTOM: 4px; MARGIN: 0em; COLOR: black; BORDER-TOP-STYLE: double; BORDER-TOP-COLOR: #d3d3d3; PADDING-TOP: 4px; BORDER-BOTTOM: #d3d3d3 4px double; BACKGROUND-COLOR: #efeff8
}
DIV.trigOuter {
	PADDING-RIGHT: 0em; PADDING-LEFT: 0em; PADDING-BOTTOM: 0em; MARGIN: 0em; PADDING-TOP: 0em
}
DIV.trigInner {
	PADDING-RIGHT: 0.5em; PADDING-LEFT: 0.5em; PADDING-BOTTOM: 0.5em; MARGIN: 0em; COLOR: black; PADDING-TOP: 0.5em; BACKGROUND-COLOR: #ffec8b
}
DIV.trigInner P {
	MARGIN-TOP: 0em; MARGIN-BOTTOM: 0em; MARGIN-LEFT: 0em
}
P.footer {
	TEXT-ALIGN: right
}
</STYLE>
</HEAD>
<BODY>
<div align="right">
  <p>Chris Bizer, Freie Universität Berlin<br>
    Richard Cyganiak, Freie Universität Berlin<br>
    Olaf Hartig, Humboldt-Universität zu Berlin</p>
</div>
<DIV class=head> 
  <H1 id=title>NG4J - Named Graphs API for Jena</H1>
  <DIV class=nav>
<P><STRONG>Nearby:</STRONG> <A 
href="http://www.w3.org/2004/03/trix/" target="_blank">W3C Named Graphs Webite</A> 
      | <A 
href="http://jena.sourceforge.net/" target="_blank">Jena - Semantic Web toolkit</A> 
      | <A 
href="http://swdev.nokia.com/trix/TriX.html" target="_blank">TriX</A> | <A 
href="http://www.wiwiss.fu-berlin.de/suhl/bizer/TriG/" target="_blank">TriG</A> 
      | <A 
href="http://www.w3.org/2001/sw/interest/"></A><A 
href="http://www.w3.org/2001/sw/interest/">Semantic Web Interest Group</A> | <A 
href="http://www.w3.org/RDF/">RDF</A> | </P>
  </DIV>
  <P>The Named Graphs API for Jena (NG4J) is an extension to the Jena Semantic 
    Web framework for parsing, manipulating and serializing sets of Named Graphs.
  </P>


<h3>News</h3>
<ul>
  <li>
    <strong>09/06/2009: NG4J wiki created</strong>.
    See the MediaWiki Hosted Application at the NG4J SourceForge site
    <a href="https://sourceforge.net/projects/ng4j/">https://sourceforge.net/projects/ng4j/</a>.
  </li>
  <li>
    <strong>20/02/2009: NG4J 0.9 released</strong>,
    with support for Apache Derby database, some bug fixes, and various code
    cleanups. Notice, we drop Java 1.4 compatibility with this release.
  </li>
  <li>
    <strong>17/11/2008: NG4J 0.8 released</strong>,
    with recent libraries (Jena 2.5.6, ARQ 2.4, and Bouncy Castle 1.41),
    support for different output formats in the command line tool of the
    Semantic Web Client Library, and some bug fixes. Lots of thanks to
    Jennifer P. Cormier for her contributions to this release.
  </li>
  <li>
    <strong>27/10/2008: Semantic Web Client Library presented</strong>. Olaf
    Hartig presented the Semantic Web Client Library during the
    <a href="http://events.linkeddata.org/iswc2008tutorial/">Linked Data Tutorial</a>
    at the <a href="http://iswc2008.semanticweb.org/">International Semantic Web Conference 2008 (ISWC'08)</a>
    in Karlsruhe, Germany. Here are the
    <a href="http://www.slideshare.net/olafhartig/the-semantic-web-client-library-consuming-linked-data-in-your-applications-presentation">slides</a>.
  </li>
  <li>
    <strong>04/09/2008: NG4J 0.7 released</strong>,
    with support for <a href="http://sindice.com">Sindice</a> based URI search
    in the <a href="semwebclient/">Semantic Web Client Library</a>, Oracle
    support for database persistence, and various bug fixes and cleaned up
    code. Lots of thanks to Jennifer P. Cormier and Olaf Hartig for their
    contributions to this release.
  </li>
  <li><strong>19/04/2007: NG4J 0.6 released</strong>, with support for <a href="http://www.w3.org/TR/grddl/">GRDDL</a> and HTML <tt>&lt;link&gt;</tt> headers in the Semantic Web Client Library, and various bug fixes and cleaned up code. Lots of thanks to Stelios Sfakianakis and Jesper Zedlitz for their contributions to this release.</li>
  <li><strong>09/10/2006: NG4J 0.5 released.</strong> The new release adds SPARQL support, the <a href="semwebclient/">Semantic Web Client Library</a>, and support for the PostgreSQL and HSQLDB databases.</li>
  <li><strong>18/10/2005: New <A href="http://lists.sourceforge.net/lists/listinfo/ng4j-namedgraphs">ng4j-namedgraphs</A> mailing list.</strong> As the NG4J user community is growing and we are receiving an increasing number of interesting new ideas around the toolkit and Named Graphs in general, we have opened up a NG4J  mailing list which is also scoped to be a forum for general discussions around Named Graphs and related technologies.</li>
  <li><strong>23/05/2005:</strong> There is ongoing work to align NG4J with <a href="http://www.w3.org/TR/2005/WD-rdf-sparql-query-20050419/#rdfDataset"><strong>SPARQL's  RDF data sets</strong></a>. Please contact Richard or Chris for information about the current status of this work.</li>
  <li><strong>15/04/2005: NG4J will be presented as a poster</strong> at the <a href="http://www.eswc2005.org/">2nd European Semantic Web Conference (ESWC 2005)</a>, Heraklion, Greece, May 2005: Christian Bizer, Richard Cyganiak, Rowland Watkins: <a href="../pub/Bizer-NG4J-ESWC2005.pdf">NG4J &ndash; Named Graphs API for Jena</a>  (<a href="../pub/Bizer-NG4J-ESWC2005-Poster.pdf">Poster</a>) . </li>
  <li><strong>10/03/2005: Named Graphs paper</strong> will be presented at <a href="http://www.WWW2005.org/">WWW2005</a>, May 10-14, 2005, in Chiba, Japan.: <a href="http://www.wiwiss.fu-berlin.de/suhl/bizer/pub/Carroll_etall-WWW2005.pdf" target="_blank">Jeremy Carroll, Chris Bizer, Pat Hayes, Patrick Stickler: Named Graphs, Provenance and Trust</a>.</li>
</ul>


<h3>Features</h3>

  <P>NG4J extends Jena with:</P>
  </DIV>
<ul>
  <li>Graph-centric and quad-centric methods for <strong>manipulating sets of Named Graphs</strong></li>
  <li><strong>In-memory</strong> or <strong>database-persisted</strong> graphset storage</li>
  <li><strong>Semantic Web Client Library</strong> which represents the complete Semantic Web as a single RDF graph</li>
  <li>Viewing graphsets as Jena models and Jena graphs</li>
  <li>Provenance-enabled Jena statements</li>
  <li>Querying of Named Graphs with the <strong>SPARQL</strong> query language</li>
  <li>Integrated parser and serializer for the <strong>TriG</strong> and <strong>TriX</strong> syntaxes including TriX syntactic extensions</li>
  <li>API support for the Semantic Web Publishing <strong>(SWP)</strong> vocabulary</li>
  <li>Creation and verification of <strong>graph signatures</strong> using X.509 certificates</li>
  <li>Directory reader and writer for importing and exporting graph sets as sets of classic RDF files.</li>
</ul>


<HR>
<h2>Contents</h2>
<ol>
  <li> 
    <DIV class=status> <A 
href="#intro">Introduction</A></DIV>
    <ol>
      <li><a href="#ng-intro">Named Graphs</a></li>
      <li><a href="#ng4j-intro">NG4J</a></li>
    </ol>
  </li>
  <li> 
    <DIV class=status><A 
href="#example">Usage Examples</A> </DIV>
    <ol>
      <li><a href="#operations">Operations on GraphSet and Model Level</a></li>
      <li><A href="#SPARQL">Querying Named Graphs with SPARQL</A></li>
      <li><A href="#Persistence">Using Database Persistence</A></li>
      <li><A href="#SWP">Semantic Web Publishing (SWP) API and Digital Signatures</A></li>
      <li><A href="#client">Semantic Web Client Library</A></li>
    </ol>
  </li>
  <li> 
    <DIV class=status><A href="#Download">Download</A> </DIV>
  </li>
  <li> 
    <DIV class=status><A href="#acknowledgements">Acknowledgements</A> </DIV>
  </li>
  <li> 
    <DIV class=status><A href="#feedback">Feedback</A> </DIV>
  </li>
</ol>
<DIV class=contents></DIV>
<HR>

<h2><A id=intro name=intro>1. Introduction</A></h2>
<P>This section gives an introduction into the ideas behind <a href="#ng-intro">Named 
  Graphs</a> and the <a href="#ng4j-intro">NG4J API</a>.</P>
<h3><A id=ng-intro name=ng-intro></A>1.1 Named Graphs</h3>
<P>The Semantic Web can be seen as a collection of RDF graphs. The RDF recommendation 
  explains the meaning of any one graph, and how to merge a set of graphs into 
  one, but does not provide suitable mechanisms for talking about graphs or relations 
  between graphs. But the ability to express metainformation about graphs is required 
  for:</P>
<ul>
  <li> <strong>Data syndication systems</strong> need to keep track of provenance 
    information, and provenance chains.</li>
  <li><strong> Restricting information usage: </strong> Information providers might 
    want to attach information about intellectual property rights or their privacy 
    preferences to graphs in order to restrict the usage of published information.</li>
  <li><strong>RDF repository housekeeping:</strong> Triple stores need mechanisms 
    to replace and update parts of their content.</li>
  <li><strong>Access control:</strong> A triple store may wish to allow fine-grain 
    access control, which appears as metadata concerning the graphs in the store.</li>
  <li><strong>Signing RDF graphs:</strong> For signing RDF graphs it is necessary 
    to keep the graph that has been signed distinct from the signature, and other 
    metadata concerning the signing, which may be kept in a second graph.</li>
  <li><strong>Expressing propositional attitudes</strong> such as modalities and 
    beliefs.</li>
  <li><strong>Scoping assertions and logic</strong> where logical relationships 
    between graphs have to be captured.</li>
</ul>
<P><br>
  RDF reification has well-known problems in addressing these use cases. To avoid 
  these problems several authors propose quads, consisting of an RDF triple and 
  a further URIref or blank node or ID. The proposals vary widely in the semantic 
  of the fourth element, using it to refer to information sources, to model IDs 
  or statement IDs or more generally to "contexts". Named Graphs propose a general 
  and simple variation on RDF, using sets of named RDF graphs. </P>
<P><DIV class="trigInner"> A set of Named Graphs is a collection of RDF graphs. Each one is named 
  with a URIref. </DIV></P>
<P>The name of a graph may occur either in the graph itself, in other graphs, 
  or not at all. Graphs may share URIrefs but not blank nodes. Named Graphs can 
  be seen as a reformulation of quads in which the fourth element's distinct syntactic 
  and semantic properties are clearly distinguished, and the relationship to RDF's 
  triples, abstract syntax and semantics is clearer.</P>
<P>Further details about Named Graphs are found in:</P>
<ul>
  <li><a href="http://www.w3.org/2004/03/trix/" target="_blank">W3C Named Graphs 
    Website</a></li>
  <li><a href="http://www.wiwiss.fu-berlin.de/suhl/bizer/pub/Carroll_etall-WWW2005.pdf" target="_blank">Jeremy 
    Carroll, Chris Bizer, Pat Hayes, Patrick Stickler: Named Graphs, Provenance 
    and Trust</a>.</li>
</ul>
<h3>&nbsp;</h3>
<h3><A id=ng4j-intro name=ng4j-intro></A>1.2 NG4J - Named Graph API for Jena</h3>
<P>The Named Graphs API for Jena (NG4J) is an extension to the Jena Semantic Web 
  toolkit for parsing, manipulating and serializing sets of Named Graphs. NG4J 
  is an exerimental implementation of the new syntaxes (TriX, TriG)
  developed within the Semantic Web Interest Group. Its purpose 
  is to have something for playing around with the new technologies. </P>
<P><strong>Jena and the Model and Graph layers</strong></P>
<P>Jena is a two-layered framework. Developers usually work with the Model
  layer, using types like Model, Statement and Resource. The Model layer
  is designed to be convenient to use for application programmers.</P>
<P>Beneath lies the Graph layer, whose most important types are Graph,
  Triple and Node. It offers functionality similar to the Model layer,
  but is less convenient to use for an application programmer, and
  is easier to work with when you design Jena system components
  like triple stores or inference engines.</P>
<P>NG4J lies between those two layers, using parts of both. Only a part of its 
  functionality is exposed at the Model layer, by the NamedGraphModel class. The 
  graph-centric and quad-centric methods are exposed directly on the Graph Layer.</P>
<P><strong>Working with NamedGraphs and Quads</strong></P>
<P>The basic idea of the NG4J API is to have a NamedGraphSet which represents a collection 
  of Named Graphs. It can can be manipulated by adding and removing entire Graphs,
  or by working with individual Quads. The NamedGraph object 
  wraps existing Jena graphs, meaning that GraphMem, GraphRDB and GraphD2RQ can 
  be reused. </P>
<P><strong>Working with Models and Resources</strong></P>
<P>You can get a Jena model view on a NamedGraphSet, which can be used like a 
  normal Jena model. The Jena Statements returned by this model or its resources 
  can be casted to NamedGraphStatements. NamedGraphStatements can provide provenance 
  information about the Named Graphs in which they are contained.</P>
<P><strong>API Overview</strong></P>
<P>The tables below give an overview about NG4J's main interfaces and their most 
  important methods. See <a href="javadoc/index.html" target="_blank">JavaDoc</a> 
  for details about all methods.</P>
<table width="100%" border="1" cellpadding="3" cellspacing="0">
  <tr> 
    <td colspan="2"><strong><a href="javadoc/de/fuberlin/wiwiss/ng4j/NamedGraph.html">NamedGraph</a></strong></td>
  </tr>
  <tr> 
    <td colspan="2">A collection of RDF triples which is named by a URI. A
      NamedGraph can be created by wrapping existing Jena graphs like
      GraphMem, GraphRDB or GraphD2RQ.</td>
  </tr>
  <tr> 
    <td width="28%">getGraphName() <br></td>
    <td width="72%">Returns the URI of the named graph. </td>
  </tr>
  <tr> 
    <td>add(Triple)</td>
    <td>Adds an triple to the NamedGraph. (inherited from Jena's Graph type)</td>
  </tr>
  <tr> 
    <td>find(TripleMatch)</td>
    <td>Returns an iterator over the query results. (inherited from Jena's Graph type)</td>
  </tr>
  <tr> 
    <td colspan="2"><a href="javadoc/de/fuberlin/wiwiss/ng4j/NamedGraph.html#method_summary">More 
      ...</a></td>
  </tr>
</table>
<P>&nbsp;</P>
<table width="100%" border="1" cellspacing="0" cellpadding="3">
  <tr> 
    <td colspan="2"><strong><a href="javadoc/de/fuberlin/wiwiss/ng4j/NamedGraphSet.html">NamedGraphSet</a></strong></td>
  </tr>
  <tr> 
    <td colspan="2">A set of Named Graphs is a collection of RDF graphs where
      each one is named with a URIref. The collection can be accessed and 
      modified by adding and removing NamedGraph instances, by adding, removing 
      and finding Quads (RDF triples with an additional graph name) and through 
      it's union graph (the RDF graph containing all statements from all graphs 
      in the set) which is accessible as a Jena Graph and as a Jena Model. NamedGraphSets 
      can be serialized using TriX and TriG. We provide a NamedGraphSet implementation 
      based on Jena graphs. Other implementations might represent information 
      as quads or build on a quad-based store like RDF Gateway.</td>
  </tr>
  <tr> 
    <td width="28%" valign="top">addGraph(namedgraph) </td>
    <td width="72%">Adds a NamedGraph to the set. </td>
  </tr>
  <tr> 
    <td valign="top">addQuad(quad)</td>
    <td>Adds a quad to the NamedGraphSet. A new NamedGraph will automatically 
      be created if necessary. </td>
  </tr>
  <tr> 
    <td valign="top">findQuads(quad)</td>
    <td>Finds Quads that match a quad pattern. </td>
  </tr>
  <tr> 
    <td valign="top">read(url, lang) <br> </td>
    <td>Read NamedGraphs from a URL into the NamedGraphSet. Supported RDF serialization 
      languages are TriX, TriG, RDF/XML, N-Triples and N3. </td>
  </tr>
  <tr> 
    <td valign="top">write(writer, lang, baseURI)</td>
    <td>Writes a serialized representation of the NamedGraphSet to a Writer. Supported 
      RDF serialization languages are TriX, TriG, RDF/XML, N-Triples and N3. If 
      the specified serialization language doesn't support Named Graphs, then 
      the union graph will be serialized, and knowledge about graph names is lost. 
      Only TriX and TriG support graph naming.<br></td>
  </tr>
  <tr> 
    <td valign="top">asJenaGraph(defaultGraphForAdding) </td>
    <td> Returns a Jena Graph view on the NamedGraphSet, equivalent to the union 
      graph of all graphs in the graph set.</td>
  </tr>
  <tr>
    <td valign="top">asJenaModel(defaultGraphForAdding)</td>
    <td>Returns a Jena Model view on the NamedGraphSet, equivalent to the union 
      graph of all graphs in the graph set. All Statements returned by this NamedGraphsModel 
      can be casted to NamedGraphStatements in order to access provenance information 
      about the graphs they are contained in.</td>
  </tr>
  <tr>
    <td colspan="2"><a href="javadoc/de/fuberlin/wiwiss/ng4j/NamedGraphSet.html#method_summary">More 
      ...</a></td>
  </tr>
</table>
<p>&nbsp;</p>
<table width="100%" border="1" cellpadding="3" cellspacing="0">
  <tr> 
    <td colspan="2"><strong><a href="javadoc/de/fuberlin/wiwiss/ng4j/NamedGraphModel.html">NamedGraphModel</a></strong> 
      implements Jena Model</td>
  </tr>
  <tr> 
    <td colspan="2">NamedGraphModel provides a resource-centric view on a NamedGraphSet. 
      It behaves like a normal Jana model based on the union graph 
      of the NamedGraphSet. Statements returned by the NamedGraphModel can be 
      casted to NamedGraphStatements which are able to provide provenance information.
      Reading RDF files into the NamedGraphModel replaces statements previously loaded
      from the same source or URL.</td>
  </tr>
  <tr> 
    <td width="28%" valign="top">getResource() <br></td>
    <td width="72%">Returns a Jena resource. Statements returned by this resource 
      can be casted to NamedGraphStatements.</td>
  </tr>
  <tr> 
    <td colspan="2">Supports all other Jena Model methods. <a href="javadoc/de/fuberlin/wiwiss/ng4j/NamedGraphSet.html#method_summary">More 
      ...</a></td>
  </tr>
</table>
<p>&nbsp;</p>
<table width="100%" border="1" cellpadding="3" cellspacing="0">
  <tr> 
    <td colspan="2"><strong><a href="javadoc/de/fuberlin/wiwiss/ng4j/NamedGraphStatement.html">NamedGraphStatement</a></strong> 
      implements Jena Statement</td>
  </tr>
  <tr> 
    <td colspan="2">A NamedGraphStatement is a Statement which can provide provenance 
      information about the NamedGraphs in which it is contained.</td>
  </tr>
  <tr> 
    <td width="28%" valign="top">listGraphs() <br>
      <br></td>
    <td width="72%">List all NamedGraphs which contain the statement.</td>
  </tr>
  <tr>
    <td valign="top">listQuads() </td>
    <td> List all quads which contain the triple of the statement.</td>
  </tr>
  <tr> 
    <td valign="top">getGraphName() </td>
    <td>Returns the name of a graph containing the statement. If several graphs
      contain the statement, one will be chosen arbitrarily. Useful if it is known
      that there is only one.</td>
  </tr>
  <tr>
    <td colspan="2"><a href="javadoc/de/fuberlin/wiwiss/ng4j/NamedGraphStatement.html#method_summary">More 
      ...</a></td>
  </tr>
</table>
<p>&nbsp;</p>
<HR title="Separator for header">
<h2><A id=example name=example>2. Usage Examples</A></h2>
<h3><a id=operations name=operations></a>2.1 Operations on GraphSet and Model 
  Level</h3>
<DIV class="trigInner"> 
  <pre>////////////////////////////////////////////////
//         Operations on GraphSet Level
////////////////////////////////////////////////

// Create a new graphset
NamedGraphSet graphset = new NamedGraphSetImpl();

// Create a new NamedGraph in the NamedGraphSet
NamedGraph graph = graphset.createGraph("http://example.org/persons/123");

// Add information to the NamedGraph
graph.add(new Triple(Node.createURI("http://richard.cyganiak.de/foaf.rdf#RichardCyganiak"),
        Node.createURI("http://xmlns.com/foaf/0.1/name") ,
        Node.createLiteral("Richard Cyganiak", null, null)));

// Create a quad
Quad quad = new Quad(Node.createURI("http://www.bizer.de/InformationAboutRichard"),
        Node.createURI("http://richard.cyganiak.de/foaf.rdf#RichardCyganiak"),
        Node.createURI("http://xmlns.com/foaf/0.1/mbox") ,
        Node.createURI("mailto:richard@cyganiak.de"));

// Add the quad to the graphset. This will create a new NamedGraph in the
// graphset.
graphset.addQuad(quad);

// Find information about Richard across all graphs in the graphset
Iterator it = graphset.findQuads( 
        Node.ANY, 
        Node.createURI("http://richard.cyganiak.de/foaf.rdf#RichardCyganiak"),
        Node.ANY,
        Node.ANY);

while (it.hasNext()) {
    Quad q = (Quad) it.next();
    System.out.println("Source: " + q.getGraphName());
    System.out.println("Statement: " + q.getTriple());
    // (This will output the two statements created above)
}

// Count all graphs in the graphset (2)
System.out.println("The graphset contains " + graphset.countGraphs() + " graphs.");

// Serialize the graphset to System.out, using the TriX syntax
graphset.write(System.out, "TRIX", null);

////////////////////////////////////////////////
//         Operations on Model Level
////////////////////////////////////////////////

// Get a Jena Model view on the GraphSet
Model model = graphset.asJenaModel("http://example.org/defaultgraph");

// Add provenance information about a graph
Resource informationAboutRichard = model.getResource("http://www.bizer.de/InformationAboutRichard");
informationAboutRichard.addProperty(model.createProperty("http://purl.org/dc/elements/1.1/author"), "Chris Bizer");
informationAboutRichard.addProperty(model.createProperty("http://purl.org/dc/elements/1.1/date"), "09/15/2004");

// Get a Jena resource and statement
Resource richard = model.getResource("http://richard.cyganiak.de/foaf.rdf#RichardCyganiak");

NamedGraphStatement mboxStmt = 
        (NamedGraphStatement) richard.getProperty(model.getProperty("http://xmlns.com/foaf/0.1/mbox"));

// Get an iterator over all graphs which contain the statement.
it = mboxStmt.listGraphNames();

// So who has published my email address all over the Web??!?
while (it.hasNext()) {
    Resource g = (Resource) it.next();
    System.out.println();
    System.out.println("GraphName: " + g.toString());
    System.out.println("Author: " + 
        g.getProperty(model.getProperty("http://purl.org/dc/elements/1.1/author")).getString());
    System.out.println("Date: " + 
        g.getProperty(model.getProperty("http://purl.org/dc/elements/1.1/date")).getString());
}

// Serialize the model to System.out, using the TriG syntax
model.write(System.out, "TRIG", "http://richard.cyganiak.de/foaf.rdf");</pre>
</DIV>
<p>When run, the example code will write <a href="example_output.txt">this output</a> to System.out.</p>
<p>&nbsp;</p>


<h3><A id="SPARQL" name="SPARQL">2.2 Querying Named Graphs with SPARQL</A></h3>

<p>The <a href="http://www.w3.org/TR/rdf-sparql-query/">SPARQL</a> RDF query language
  supports queries on sets of named graphs. The <tt>GRAPH</tt> keyword can be used
  to select a specific graph, or to bind to a variable the names of all graphs
  whose contents match a query pattern:</p>

<DIV class="trigInner">
  <pre>PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
SELECT ?otherFoafFile
WHERE {
  GRAPH &lt;http://example.org/my-foaf.rdf&gt; {
    ?me foaf:mbox &lt;mailto:me@example.org&gt; .
  }
  GRAPH ?otherFoafFile {
    ?otherFoafFile foaf:maker ?someone
    ?someone foaf:knows ?me .
  }
}</pre>
</DIV>

<p>The first part reads my FOAF file and selects the resource representing
  me (by matching my email address). The second part finds and
  returns all FOAF files whose makers claim to know me. Note that all
  the files in question must have been loaded into the graph set before
  the query is executed.</p>

<p>As an alternative approach, NG4J also includes a
  <a href="semwebclient/">Semantic Web Client</a> that tries to load
  files transparently from the Web as required to answer a query.</p>

<p>Here's the code for running a SPARQL query against a NamedGraphSet:</p>

<DIV class="trigInner">
<pre>Query sparql = QueryFactory.create(
        "SELECT * WHERE { GRAPH ?graph { ?s ?p ?o } }");
QueryExecution qe = QueryExecutionFactory.create(
        sparql, new NamedGraphDataset(set));
ResultSet results = qe.execSelect();
while (results.hasNext()) {
    QuerySolution result = results.nextSolution();
    RDFNode graph = result.get("graph");
    RDFNode s = result.get("s");
    RDFNode p = result.get("p");
    RDFNode o = result.get("o");
    System.out.println(graph + " { " + s + " " + p + " " + o + " . }");
}</pre>
</DIV>
<p>This will run the query and print the results.</p>


<p>&nbsp;</p>
<h3><A id=Persistence name=Persistence>2.3 Using Database Persistence</A></h3>
<p>NamedGraphSets can be stored in a relational database. As of NG4J v0.9,
   HSQLDB, MySQL, Oracle, PostgreSQL, and Apache Derby are supported. To create a persistent
   NamedGraphSet, you have to set up a java.sql database connection and create
   a new NamedGraphSetDB instance:</p>


<DIV class="trigInner">
  <pre>String URL = "jdbc:mysql://localhost/db_name";
String USER = "username";
String PW = "mypassword";
Class.forName("com.mysql.jdbc.Driver");
Connection connection = DriverManager.getConnection(URL, USER, PW);
NamedGraphSet set = new NamedGraphSetDB(connection);
// ...
set.close();
</pre>
</DIV>
<p>The resulting NamedGraphSet can be used just like a normal in-memory NamedGraphSet.</p>
<p>Optionally, you can specify a table prefix that will be stuck in front of all database table names. This allows multiple NamedGraphSets to coexist in the same database. There's also a method for deleting sets from the database.
<DIV class="trigInner">
  <pre>NamedGraphSet set = new NamedGraphSetDB(connection, "myapp");
// ...
NamedGraphSetDB.delete(connection, "myapp");</pre>
</DIV>
<p>&nbsp;</p>

<h3 id="SWP">2.4 Semantic Web Publishing (SWP) API and Digital Signatures</h3>
<p><strong>Working with Digital Signatures and Named Graphs</strong></p>

<p>The Semantic Web Publishing Vocabulary (SWP) is used for publishing Named Graphs on the Web. It allows authorities to indicate whether they assert or quote a graph and to sign graphs using digital signatures. More information about the SWP vocabulary is available on the <a href="http://www.wiwiss.fu-berlin.de/suhl/bizer/TriQLP/">TriQL.P Trust Architecture</a> page.</p>

<p>The SWP API in NG4J builds on the NamedGraphSet inferface. Named Graphs are asserted or quoted by an SWPAuthority, a service or person that is able to publish information. The authority must have a valid X.509 certificate in order to be able to sign Named Graphs.</p>

<p><strong>Signing Named Graphs</strong></p>

<p>The general algorithm for signing and recording the digital signature of a Named Graph is as follows:</p>

<ul>
<li>Take a Named Graph and find its canonical representation (see <a href="http://www.hpl.hp.com/techreports/2003/HPL-2003-142.pdf">Jeremy Carroll: Signing RDF Graphs</a>).</li>
<li>Using a common secure hash (SHA-1 or stronger), record the digest of the canonical Named Graph.</li>
<li>We place the digest into a separate Named Graph which we call a Warrant Graph. Besides asserting or quoting the original graph, the Warrant Graph also <em>asserts itself</em>. More on Warrant Graphs in section 5 of the <a href="http://www.hpl.hp.com/techreports/2004/HPL-2004-57">Named Graphs paper</a>.</li>
<li>Finally, take the canonical representation of the Warrant Graph and sign it with the SWPAuthority's private key, using a common secure method (SHA1WithDSA or SHA1WithRSA). Add the signature to the Warrant Graph.</li>
<li>Now, the signed Warrant Graph can be published.</li>
</ul>

<p><strong>Verifying Signatures</strong></p>

<p>Named Graph digital signatures can be verified in the following manner:</p>

<ul>
<li>Retrieve the Named Graph's Warrant Graph and extract the digital signature and X.509 certificate. We retrieve the X.509 certificate, because we want to have access to the SWPAuthority's public key.</li>
<li>Verify the signature on the Warrant Graph using the public key. If this verification succeeds, we know that the SWPAuthority has published the Named Graph.</li>
<li>Again, find the Named Graph's canonical representation and its digest.</li>
<li>Compare the digest to the one recorded int the Warrant Graph. If they don't match, then the Named Graph has changed it's contents since it was signed. We count this as a verification failure.</li>
<li>If the digests did match, verification was successful.</li>
</ul>

<table width="100%" border="1" cellspacing="0" cellpadding="3">
  <tr> 
    <td colspan="2"><strong><a href="javadoc/de/fuberlin/wiwiss/ng4j/swp/SWPNamedGraphSet.html">SWPNamedGraphSet</a></strong></td>
  </tr>
  <tr> 
    <td colspan="2">An extension to <a href="javadoc/de/fuberlin/wiwiss/ng4j/NamedGraphSet.html">NamedGraphSet</a> that handles various types of digital signature; options include signing each graph in the set or the NamedGraphSet as a whole. </td>
  </tr>

  <tr> 
    <td valign="top"><b>swpAssert</b>(SWPAuthority authority)</td>
    <td><em>Assert</em> all graphs in the graphset with the given Authority, but don't sign the resulting Warrant.</td>
  </tr>

  <tr> 
    <td valign="top"><b>swpQuote</b>(SWPAuthority authority) <br /> </td>
    <td><em>Quote</em> all graphs in the graphset with the given Authority, but don't sign the resulting Warrant.</td>
  </tr>
  <tr> 
    <td valign="top"><b>assertWithSignature</b>(SWPAuthority authority, <br />
    					Node signatureMethod, <br />
    					Node digestMethod, <br />
    					ArrayList listOfAuthorityProperties, <br />
    					String keystore, <br />
    					String password )</td>
    <td><em>Assert</em> all graphs in the graphset with the given Authority and sign the asserted graph with a digital signature according to the specified signatureMethod.</td>
  </tr>
  <tr> 
    <td valign="top"><b>quoteWithSignature</b>( SWPAuthority authority, <br />
    					Node signatureMethod, <br />
    					Node digestMethod, <br />
    					ArrayList listOfAuthorityProperties, <br />
    					String keystore, <br />
    					String password ) </td>
    <td><em>Quote</em> all graphs in the graphset with the given Authority and sign the asserted graph with a digital signature according to the specified signatureMethod.</td>
  </tr>
  <tr>
    <td valign="top"><b>verifyAllSignatures</b>()</td>
    <td>Verify all signatures and graph digests in the NamedGraphSet.</td>
  </tr>
  <tr>
    <td colspan="2"><a href="javadoc/de/fuberlin/wiwiss/ng4j/swp/SWPNamedGraphSet.html#method_summary">More ...</a></td>
  </tr>
</table>
<br />

<table width="100%" border="1" cellspacing="0" cellpadding="3">
  <tr> 
    <td colspan="2"><strong><a href="javadoc/de/fuberlin/wiwiss/ng4j/swp/SWPAuthority.html">SWPAuthority</a></strong></td>
  </tr>
  <tr> 
    <td colspan="2">Represents a person or service that is able to publish information.</td>
  </tr>
  <tr> 
    <td width="28%" valign="top"><b>setID</b>(Node id) </td>
    <td width="72%">Sets the ID of the authority. Authorities can by identified using a URIref or a bNode </td>
  </tr>
  <tr> 
    <td valign="top"><b>setLabel</b>(String label)</td>
    <td> Sets the Label / Name of the authority. Will be serialized using rdfs:label</td>
  </tr>
  <tr> 
    <td valign="top"><b>setEmail</b>(String email)</td>
    <td> Sets the eMail address of the authority. Will be serialized using foaf:mbox<br /></td>
  </tr>
  <tr>
    <td valign="top"><b>setPublicKey</b>(PublicKey key)</td>
    <td>Sets the public key of the authority. Will be serialized using swp:hasKey</td>
  </tr>
  <tr>
    <td valign="top"><b>setCertificate</b>(X509Certificate cert)</td>
    <td>Sets the X.509 certificate of the authority.</td>
  </tr>
  <tr>
    <td valign="top"><b>addProperty</b>(Node predicate, Node object)</td>
    <td>Adds an additional property of the authority.</td>
  </tr>
  <tr>
    <td valign="top"><b>addDescriptionToGraph</b>(NamedGraph graph, ArrayList listOfAuthorityProperties)</td>
    <td>Given a NamedGraph and an arraylist of properties, add properties and Authority properties to the NamedGraph.</td>
  </tr>
  <tr>
    <td colspan="2"><a href="javadoc/de/fuberlin/wiwiss/ng4j/swp/SWPAuthority.html#method_summary">More ...</a></td>
  </tr>
</table>
<br />
<p><strong>Usage Example</strong></p>
<DIV class="trigInner">
  <pre>SWPNamedGraphSet set = new SWPNamedGraphSetImpl();
	
//Create an SWPAuthority so we can assert/quote graphs
SWPAuthority auth = new SWPAuthorityImpl();

// set the email addr of the authority (FOAF vocabulary)
auth.setEmail("mailto:rowland@grid.cx");

// set the ID of the authority
auth.setID(Node.createURI("http://grid.cx/rowland"));

// set the X.509 certificate using the users' PKCS #12 keystore
Certificate[] chain = de.fuberlin.wiwiss.ng4j.swp.utils.PKCS12Utils.getCertChain(keystore, password);
auth.setCertificate((X509Certificate )chain[0]);

String keystore = "/path/to/your/pkcs12/keystore";
String password = "passwd";

// Assert all graphs in the NamedGraphSet
// We provide an Authority, a Node specifying the signature algorithm (SHA1WithRSA),
// a Node specifying the digest method (SHA-1), a null list of properties,
// a path the a PKCS #12 keystore, and its password.
set.assertWithSignature(auth, 
			SWP.JjcRdfC14N_rsa_sha1, 
			SWP.JjcRdfC14N_sha1, 
			null, 
			keystore, 
			password);

// Verify all signatures in the NamedGraphSet
set.verifyAllSignatures();

// print out the resulting NamedGraphSet
set.write(System.out, "TRIG", "");</pre>
</DIV>
<p>The output might look <a href="http://www.wiwiss.fu-berlin.de/suhl/bizer/TriQLP/swp/SWP2-AssertWithSignature-Example.trig">like this</a>.</p>

<p>&nbsp;</p>

<p><strong>Manipulating PKCS #12 keystores</strong></p>

The SWP Framework relies heavily on the PKI (Public Key Infrastructure) to provide reliable cryptographic digital signatures, and non-repudiation of signatures.

<strong>Generating PKCS #12 keystores</strong> 

<p>Unless you are willing to write certificate management tools yourself, using Bouncy Castle, Cryptix or IAIK, you will most likely want to use OpenSSL to generate and manage your certificates.</p>

<p>While OpenSSL provides a wide range of options got generating DSA and RSA keys with other features, it can be very cumbersome to use. Each OpenSSL distribution should contain a perl script called <a href="http://www.openssl.org/docs/apps/CA.pl.html">CA.pl</a> which makes life a little bit easier.</p>

<p>Before you can generate your own certificates, you need to have a Certificate Authority (CA) that can be used to vouch for the veracity of your certificate. Unless you already have a CA, you will want to make your own.</p>

<p><strong>Generating the CA</strong>: The CA can can be generated using the CA.pl script using the following command:</p>
<div class="trigInner">
<pre>./CA.pl -newca</pre>
</div>

<p><strong>User certifcates</strong> can be generated by first creating a certificate request, to be signed by the CA:</p>

<div class="trigInner">
<pre>./CA.pl -newreq
./CA.pl -sign</pre>
</div>

<p>Once you have your certicate request signed, you can then package it into a <strong>PKCS #12 keystore</strong>. The following command will achieve this:</p>
<div class="trigInner">
<pre>./CA.pl -pkcs12</pre>
</div>

<p>You should now have a file called <tt>newcert.p12</tt>. This is the file that you should use as input to any of the methods in SWPNamedGraphSet.</p>

<p>&nbsp;</p>

<h3 id="client">2.5 Semantic Web Client Library</h3>

<p>NG4J's Semantic Web Client Library represents the complete Semantic Web
as a single set of named graphs. When queried, the <tt>SemanticWebClient</tt>
dynamically retrieves information from the Semantic Web by dereferencing
HTTP URIs, by following <tt>rdfs:seeAlso</tt> links, and by
querying the <a href="http://sindice.com" target="_blank">Sindice</a> search
engine.
It is described in a separate document:
<a href="semwebclient/"><strong>Semantic Web Client Library</strong></a>.</p>

<hr />
<p>&nbsp;</p>
<h2><A id=Download name=Download>3. Download</A></h2>
<ul>
  <li>NG4J can be downloaded from Sourceforge: <a href="http://sourceforge.net/projects/ng4j/" target="_blank">http://sourceforge.net/projects/ng4j/ 
    </a></li>
  <li>NG4J version 0.9 is designed to work with Jena 2.5.6, which is included with the NG4J distribution. 
    Expect problems when using it with different versions of Jena.</li>
  <li>NG4J is licensed under the terms of the Berkeley Software Distribution (BSD) License.</li>
</ul>
<TABLE border=1>
  <TBODY>
    <TR bgColor=#cccccc> 
      <TH> Version </TH>
      <TH> Comment </TH>
      <TH>Release Date</TH>
    </TR>
    <TR>
      <TD align=middle>V0.9</TD>
      <TD align=left>Support for Apache Derby database added; Java 1.4 compatibility dropped; TriQL removed; bugfixes and code cleanups.</TD>
      <TD align=middle valign="top">2009-02-20</TD>
    </TR>
    <TR>
      <TD align=middle>V0.8</TD>
      <TD align=left>Upgrade to the latest versions of Jena and ARQ (Jena 2.5.6, ARQ 2.4); support for different output formats in the command line tool of the Semantic Web Client Library; bugfixes; deprecated TriQL (please use SPARQL queries instead).</TD>
      <TD align=middle valign="top">2008-11-17</TD>
    </TR>
    <TR>
      <TD align=middle>V0.7</TD>
      <TD align=left>Support for URI based search with the <a href="http://sindice.com">Sindice search engine</a> and management of 303 redirects in the Semantic Web Client Library, database persistence with Oracle supported, Bouncy Castle libraries updated to version 138, code refactoring and bugfixes.</TD>
      <TD align=middle valign="top">2008-09-04</TD>
    </TR>
    <TR>
      <TD align=middle>V0.6</TD>
      <TD align=left>Support for GRDDL in the Semantic Web Client Library, bugfixes.</TD>
      <TD align=middle valign="top">2007-04-19</TD>
    </TR>
    <TR> 
      <TD align=middle>V0.5</TD>
      <TD align=left>Semantic Web Client Library, SPARQL support, PostgreSQL and HSQLDB support, bugfixes.</TD>
      <TD align=middle valign="top">2006-10-09</TD>
    </TR>
    <TR> 
      <TD align=middle>V0.4</TD>
      <TD align=left>SWP and X.509 signatures support, TriQL improvements, bugfixes.</TD>
      <TD align=middle valign="top">2005-02-24</TD>
    </TR>
    <TR> 
      <TD align=middle>V0.3</TD>
      <TD align=left>TriG support, TriX syntactic extensions support,
        Jena 2.2 compatibility, bugfixes and minor improvements.</TD>
      <TD align=middle valign="top">2004-12-17</TD>
    </TR>
    <TR> 
      <TD align=middle>V0.2</TD>
      <TD align=left>TriQL support, MySQL persistence added.</TD>
      <TD align=middle valign="top">2004-11-02</TD>
    </TR>
    <TR> 
      <TD align=middle>V0.1</TD>
      <TD align=left>Initial release.</TD>
      <TD align=middle valign="top">2004-09-14</TD>
    </TR>
  </TBODY>
</TABLE>
<p><A href="http://sourceforge.net"> <IMG src="http://sourceforge.net/sflogo.php?group_id=118754&amp;type=5" width="210" height="62" border="0" alt="SourceForge.net Logo" /></A></p>

<HR title="Separator for header">
<h2><A id=acknowledgements name=acknowledgements>4. Acknowledgements</A></h2>
<p>NG4J is developed by:
<ul>
  <li>Chris Bizer (<a href="mailto:chris@bizer.de">chris@bizer.de</a>, <a href="http://www.bizer.de" target="_blank">www.bizer.de</a>)</li>
  <li>Richard Cyganiak (<a href="mailto:richard@cyganiak.de">richard@cyganiak.de</a>, <a href="http://richard.cyganiak.de/" target="_blank">richard.cyganiak.de</a>)</li>
  <li>Tobias Gau&szlig; (<a href="mailto:tobias.gauss@web.de">tobias.gauss@web.de</a>)</li>
  <li>Olaf Hartig (<a href="mailto:hartig[at]informatik.hu.berlin.de">hartig at informatik.hu.berlin.de</a>, <a href="http://olafhartig.de" target="_blank">olafhartig.de</a>)</li>
  <li>Jennifer P. Cormier (<a href="mailto:jennifer[at]atc-nycorp.com">jennifer at atc-nycorp.com</a>)</li>
</ul>
<p>Lots of thanks to those who have contributed to the project:</p>
<ul>
  <li>Rowland Watkins (erw01r at ecs.soton.ac.uk) for his work on the SWP API.</li>
  <li>Stelios Sfakianakis (ssfak at ics.forth.gr) for implementing the GRDDL support.</li>
  <li>Jesper Zedlitz (jesper at zedlitz.de) for his work on the unit tests and build system.</li>
<!--  <li>Jennifer P. Cormier (jennifer at atc-nycorp.com) for various bug fixes, refactoring the database code, adding Oracle support, and enabling the upgrade to recent versions of Jena and ARQ.</li> -->
</ul>

<HR title="Separator for header">
<h2><A id=feedback name=feedback>5. Support and Feedback</A></h2>
<p>We are interested in hearing about your opinion and your experience with NG4J.
Please sent comments and bug reports to the NG4J-namedgraphs mailing list:</p>
<p><a href="mailto:ng4j-namedgraphs@lists.sourceforge.net">ng4j-namedgraphs@lists.sourceforge.net</a></p>
<p>The archives of the list are found at <a href="http://sourceforge.net/mailarchive/forum.php?forum=ng4j-namedgraphs">http://sourceforge.net/mailarchive/forum.php?forum=ng4j-namedgraphs </a><br />
  You can subscribe to the list at <a href="http://lists.sourceforge.net/lists/listinfo/ng4j-namedgraphs">http://lists.sourceforge.net/lists/listinfo/ng4j-namedgraphs</a>.</p>
<HR title="Separator for header">
<p>$Date: 2009/06/10 20:26:51 $<br />
  $Id: index.html,v 1.35 2009/06/10 20:26:51 jenpc Exp $</p>
</BODY>
</HTML>
